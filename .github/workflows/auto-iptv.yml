name: IPTV è‡ªåŠ¨åˆå¹¶å¹¶è¿‡æ»¤æœ‰æ•ˆé¢‘é“

on:
  schedule:
    - cron: '10 23 * * *' # æ¯å¤© UTC+8 ä¸Šåˆ 7:10 è¿è¡Œ
  workflow_dispatch:

jobs:
  run:
    runs-on: ubuntu-latest

    steps:
      - name: âœ… Checkout ä»“åº“
        uses: actions/checkout@v4

      - name: ğŸ è®¾ç½® Python ç¯å¢ƒ
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: ğŸ“¦ å®‰è£…ä¾èµ–
        run: pip install requests tqdm

      - name: ğŸ§  è¿è¡Œåˆå¹¶ä¸ç­›é€‰è„šæœ¬
        run: python py/merge_and_filter.py

      - name: ğŸ“¤ æäº¤ç»“æœå› GitHub
        run: |
          git config --local user.name "GitHub Action"
          git config --local user.email "action@github.com"
          git add merge.m3u valid.m3u
          git commit -m "ğŸ¤– è‡ªåŠ¨åˆå¹¶ + æœ‰æ•ˆé¢‘é“æ›´æ–°" || echo "No changes"
          git push
